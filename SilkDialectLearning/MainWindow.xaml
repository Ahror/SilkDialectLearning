<controls:MetroWindow x:Class="SilkDialectLearning.MainWindow"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
                      xmlns:local="clr-namespace:SilkDialectLearning"
                      xmlns:converters="clr-namespace:SilkDialectLearning.Converters"
                      xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                      xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
                      xmlns:Actions="clr-namespace:SilkDialectLearning.Actions"
                      xmlns:bl="clr-namespace:SilkDialectLearningBLL"
                      xmlns:views="clr-namespace:SilkDialectLearning.Views"
                      Title="Silk Dialect Learning" 
                      Height="597" Width="852"
                      SaveWindowPosition="True"
                      ShowIconOnTitleBar="True"
                      ShowTitleBar="True"
                      WindowStartupLocation="CenterScreen"
                      GlowBrush="{DynamicResource AccentColorBrush}">

    <controls:MetroWindow.Resources>
        <ResourceDictionary>
            <Style TargetType="Border" x:Key="TabItemHeader">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderBrush" Value="{DynamicResource  GrayBrush8}"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="BorderBrush" Value="{DynamicResource AccentColorBrush}"/>
                        <Setter Property="Background" Value="#11000000"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            <Style TargetType="{x:Type TabItem}" x:Key="TabItemStyle">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type TabItem}">
                            <Grid>
                                <Border Style="{StaticResource TabItemHeader}" Margin="0 0 -2 5" BorderThickness="0 0 6 0">
                                    <Grid>
                                        <TextBlock Name="TextBlockArrow" Visibility="Hidden" Text="u" FontSize="24" FontFamily="Wingdings 3" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="-3 0 -1 0" Foreground="#FFDDDDDD"/>
                                        <ContentPresenter x:Name="ContentSite" ContentSource="Header" Margin="8 6 0 28" Height="20">
                                            <ContentPresenter.LayoutTransform>
                                                <RotateTransform Angle="90" />
                                            </ContentPresenter.LayoutTransform>
                                        </ContentPresenter>
                                    </Grid>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Panel.ZIndex" Value="500" />
                                    <Setter TargetName="TextBlockArrow" Property="Visibility" Value="Visible"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </controls:MetroWindow.Resources>
    <controls:MetroWindow.TitleTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Content, Converter={StaticResource ToUpperConverter}}"
                       TextTrimming="CharacterEllipsis"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Center"
                       Margin="0 -1 8 0"
                       FontSize="{DynamicResource WindowTitleFontSize}"
                       FontFamily="{DynamicResource HeaderFontFamily}" />
        </DataTemplate>
    </controls:MetroWindow.TitleTemplate>
    <controls:MetroWindow.LeftWindowCommands>
        <controls:WindowCommands>
            <Button Name="HomeButton" Click="HomeButton_Click">
                <Rectangle Width="20"
                           Height="20"
                           Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill"
                                     Visual="{DynamicResource appbar_home}" />
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
        </controls:WindowCommands>
    </controls:MetroWindow.LeftWindowCommands>
    <controls:MetroWindow.RightWindowCommands>
        <controls:WindowCommands>
            <Button>
                <Rectangle Width="20"
                           Height="20"
                           Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill"
                                     Visual="{DynamicResource appbar_settings}" />
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
        </controls:WindowCommands>
    </controls:MetroWindow.RightWindowCommands>
    <controls:MetroWindow.Flyouts>
        <controls:FlyoutsControl x:Name="flyoutsControl">
            <controls:FlyoutsControl.ItemContainerStyle>
                <Style TargetType="{x:Type controls:Flyout}">
                    <Setter Property="Background" Value="#FF252525"/>
                </Style>
            </controls:FlyoutsControl.ItemContainerStyle>
            <controls:Flyout x:Name="menu" 
                             Header="Home" Position="Left"
                             Theme="Dark" TitleVisibility="Collapsed"
                             AnimateOpacity="True"
                             IsPinned="False"
                             >
                <Grid Width="300">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="50" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <DockPanel Grid.Row="0">
                        <Button x:Name="PART_BackButton" DockPanel.Dock="Left"
                                Style="{DynamicResource MetroCircleButtonStyle}"
                                Height="40"
                                Width="40"
                                FontFamily="Segoe UI Symbol"
                                FontSize="16"
                                VerticalAlignment="Center"
                                IsEnabled="False">
                            <Rectangle Width="17" Height="14"
                                       Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}">
                                <Rectangle.OpacityMask>
                                    <VisualBrush Stretch="Fill"
                                     Visual="{DynamicResource appbar_arrow_right}" />
                                </Rectangle.OpacityMask>
                            </Rectangle>
                            <Button.LayoutTransform>
                                <ScaleTransform ScaleX="-1" />
                            </Button.LayoutTransform>
                        </Button>
                        <Label FontSize="20" x:Name="PART_Title"
                               VerticalAlignment="Center" Margin="2 0 0 0"/>
                        <Button x:Name="PART_ForwardButton"
                                DockPanel.Dock="Right"
                                Style="{DynamicResource MetroCircleButtonStyle}" 
                                Height="40"
                                Width="40" 
                                FontFamily="Segoe UI Symbol"
                                FontSize="16"
                                VerticalAlignment="Center" 
                                HorizontalAlignment="Right" 
                                Visibility="Collapsed">
                            <Rectangle Width="20"
                           Height="15">
                                <Rectangle.Fill>
                                    <VisualBrush Stretch="Fill">
                                        <VisualBrush.Visual>
                                            <Canvas Width="48"
                                        Height="48"
                                        Clip="F1 M 0,0L 48,0L 48,48L 0,48L 0,0"
                                        UseLayoutRounding="False">
                                                <Path Width="25"
                                          Height="18"
                                          Canvas.Left="12"
                                          Canvas.Top="15"
                                          Stretch="Fill"
                                          Fill="{DynamicResource BlackBrush}"
                                          Data="F1 M 12,22L 12,26L 28.25,26L 21,33L 27.5,33L 37,24L 27.5,15L 21,15L 28.25,22L 12,22 Z " />
                                            </Canvas>
                                        </VisualBrush.Visual>
                                    </VisualBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Button>
                        <Button x:Name="PART_AddButton"
                                DockPanel.Dock="Right"
                                Margin="0 0 10 0"
                                Style="{DynamicResource MetroCircleAddButtonStyle}" 
                                Height="40"
                                Width="40" 
                                FontFamily="Segoe UI Symbol"
                                FontSize="16"
                                VerticalAlignment="Center" 
                                HorizontalAlignment="Right">

                            <Rectangle Width="17" Height="14"
                                       Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Button}}}">
                                <Rectangle.OpacityMask>
                                    <VisualBrush Stretch="Fill"
                                     Visual="{DynamicResource appbar_add}" />
                                </Rectangle.OpacityMask>
                            </Rectangle>
                        </Button>
                    </DockPanel>
                    <Grid Grid.Row="1">
                        <ContentPresenter Panel.ZIndex="1"
                              Content="{Binding OverlayContent, RelativeSource={RelativeSource AncestorType=local:MainWindow,Mode=FindAncestor}}" />
                        <Frame x:Name="PART_Frame"
                               NavigationUIVisibility="Hidden"
                               Margin="3 0 3 0"/>
                    </Grid>
                </Grid>
            </controls:Flyout>
        </controls:FlyoutsControl>
    </controls:MetroWindow.Flyouts>
    <Grid>
        <Grid>
            <Grid.Resources>
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml" />
            </Grid.Resources>
            <TabControl Name="MainTabControl" TabStripPlacement="Right">
                <TabItem Header="Scene" Style="{DynamicResource TabItemStyle}">
                    <views:SceneView ViewModel="{Binding Path=ViewModel}"/>
                </TabItem>
                <TabItem Header="Vocab" Style="{DynamicResource TabItemStyle}"></TabItem>
            </TabControl>
        </Grid>
    </Grid>
</controls:MetroWindow>
